module.exports=[35112,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactDOM},38783,(a,b,c)=>{"use strict";b.exports=a.r(42602).vendored["react-ssr"].ReactServerDOMTurbopackClient},77577,a=>{"use strict";var b=a.i(15319),c=a.i(47033);a.s(["storage",0,{getAllBusinesses:async()=>[],getBusinessByPhone:async a=>await b.db.getBusinessByPhone(a),getBusinessById:async a=>await b.db.getBusinessById(a),createBusiness:async a=>{await b.db.createBusiness(a,"")},updateBusiness:async(a,c)=>{await b.db.updateBusiness(a,c)},getConversationsByBusinessId:async a=>await b.db.getConversationsByBusinessId(a),getConversationById:async a=>await b.db.getConversationById(a),createConversation:async a=>{if(!a.customerEmail)throw Error("customerEmail is required to create a conversation");await b.db.createConversation(a)},updateConversation:async(a,c)=>{await b.db.updateConversation(a,c)},getAuth:async()=>await c.auth.getCurrentUser(),setAuth:async a=>{},clearAuth:async()=>{await c.auth.signOut()}}])},20226,a=>{"use strict";var b=a.i(72131);let c=a=>{let b,c=new Set,d=(a,d)=>{let e="function"==typeof a?a(b):a;if(!Object.is(e,b)){let a=b;b=(null!=d?d:"object"!=typeof e||null===e)?e:Object.assign({},b,e),c.forEach(c=>c(b,a))}},e=()=>b,f={setState:d,getState:e,getInitialState:()=>g,subscribe:a=>(c.add(a),()=>c.delete(a))},g=b=a(d,e,f);return f},d=a=>{let d=a?c(a):c,e=a=>(function(a,c=a=>a){let d=b.default.useSyncExternalStore(a.subscribe,b.default.useCallback(()=>c(a.getState()),[a,c]),b.default.useCallback(()=>c(a.getInitialState()),[a,c]));return b.default.useDebugValue(d),d})(d,a);return Object.assign(e,d),e},e=a=>a?d(a):d;a.s(["create",()=>e],20226)},45763,a=>{"use strict";var b=a.i(20226),c=a.i(77577);let d=(0,b.create)(a=>({user:null,loading:!0,initialized:!1,loadAuth:async()=>{a({loading:!0});try{let b=await c.storage.getAuth();return a({user:b,loading:!1,initialized:!0}),b}catch(b){return console.error("Error loading auth:",b),a({user:null,loading:!1,initialized:!0}),null}},setUser:b=>a({user:b}),clearAuth:async()=>{await c.storage.clearAuth(),a({user:null})},updateBusiness:b=>{a(a=>({user:a.user?{...a.user,business:b}:null}))}}));a.s(["useAuthStore",0,d])},50463,a=>{"use strict";var b=a.i(87924),c=a.i(97895);function d({className:a,...d}){return(0,b.jsx)("div",{"data-slot":"skeleton",className:(0,c.cn)("bg-accent animate-pulse rounded-md",a),...d})}a.s(["Skeleton",()=>d])},46842,a=>{"use strict";let b=(0,a.i(70106).default)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);a.s(["User",()=>b],46842)},66680,(a,b,c)=>{b.exports=a.x("node:crypto",()=>require("node:crypto"))},49666,a=>{"use strict";var b=a.i(66680);let c={randomUUID:b.randomUUID},d=new Uint8Array(256),e=d.length,f=[];for(let a=0;a<256;++a)f.push((a+256).toString(16).slice(1));a.s(["v4",0,function(a,g,h){if(c.randomUUID&&!g&&!a)return c.randomUUID();var i=a,j=h;let k=(i=i||{}).random??i.rng?.()??(e>d.length-16&&((0,b.randomFillSync)(d),e=0),d.slice(e,e+=16));if(k.length<16)throw Error("Random bytes length must be >= 16");if(k[6]=15&k[6]|64,k[8]=63&k[8]|128,g){if((j=j||0)<0||j+16>g.length)throw RangeError(`UUID byte range ${j}:${j+15} is out of buffer bounds`);for(let a=0;a<16;++a)g[j+a]=k[a];return g}return function(a,b=0){return(f[a[b+0]]+f[a[b+1]]+f[a[b+2]]+f[a[b+3]]+"-"+f[a[b+4]]+f[a[b+5]]+"-"+f[a[b+6]]+f[a[b+7]]+"-"+f[a[b+8]]+f[a[b+9]]+"-"+f[a[b+10]]+f[a[b+11]]+f[a[b+12]]+f[a[b+13]]+f[a[b+14]]+f[a[b+15]]).toLowerCase()}(k)}],49666)},13749,a=>{"use strict";let b=(0,a.i(70106).default)("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);a.s(["ChevronLeft",()=>b],13749)},57417,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(50944),e=a.i(40695),f=a.i(46271),g=a.i(77577),h=a.i(69240),i=a.i(49666);async function j(a,b){let c=(0,h.createClient)(),{data:{user:d},error:e}=await c.auth.getUser();if(e||!d)throw Error("User must be authenticated to upload business logo");if(d.id!==b)throw Error("Business ID must match authenticated user ID");let f=a.name.split(".").pop(),g=`${(0,i.v4)()}.${f}`,j=`${b}/${g}`,{data:k,error:l}=await c.storage.from("business_logo").upload(j,a,{cacheControl:"3600",upsert:!1});if(l)throw console.error("Storage upload error:",l),Error(`Failed to upload business logo: ${l.message}`);let{data:{publicUrl:m}}=c.storage.from("business_logo").getPublicUrl(k.path);return m}async function k(a){let b=(0,h.createClient)(),c=new URL(a).pathname.split("/"),d=c.slice(c.indexOf("business_logo")+1).join("/"),{error:e}=await b.storage.from("business_logo").remove([d]);e&&console.error("Failed to delete business logo:",e)}var l=a.i(38246),m=a.i(13749),n=a.i(70106);let o=(0,n.default)("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);var p=a.i(46842);let q=(0,n.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),r=(0,n.default)("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);var s=a.i(71987),t=a.i(50463),u=a.i(45763);function v(){let a=(0,d.useRouter)(),h=(0,c.useRef)(null),{user:i,loading:n,initialized:v,loadAuth:w,updateBusiness:x}=(0,u.useAuthStore)(),[y,z]=(0,c.useState)(""),[A,B]=(0,c.useState)(""),[C,D]=(0,c.useState)(""),[E,F]=(0,c.useState)(!0),[G,H]=(0,c.useState)(""),[I,J]=(0,c.useState)(!1),[K,L]=(0,c.useState)(!1),[M,N]=(0,c.useState)(""),[O,P]=(0,c.useState)(""),[Q,R]=(0,c.useState)(!1),S=a=>!!a&&!!(a.businessName&&a.phone&&a.address);(0,c.useEffect)(()=>{if(v)if(i?.business){if(!S(i.business))return void a.push("/onboarding");z(i.business.businessName),B(i.business.phone),D(i.business.address),F(i.business.online),H(i.business.businessLogo||"")}else i||a.push("/login");else w().then(b=>{b?S(b.business)||a.push("/onboarding"):a.push("/login")})},[v,i,w,a]);let T=async a=>{a.preventDefault(),N(""),P(""),L(!0);try{if(!i?.business)return;await g.storage.updateBusiness(i.business.id,{businessName:y,phone:A,address:C,online:E,businessLogo:G||void 0});let a=await g.storage.getBusinessById(i.business.id);a&&(x(a),P("Settings saved successfully!"),setTimeout(()=>P(""),3e3))}catch(a){N("Failed to save settings")}finally{L(!1)}},U=async a=>{let b=a.target.files?.[0];if(b&&i?.business){if(!b.type.startsWith("image/"))return void N("Please select an image file");if(b.size>5242880)return void N("Image size must be less than 5MB");J(!0),N("");try{G&&await k(G);let a=await j(b,i.business.id);H(a),P("Profile picture updated!"),setTimeout(()=>P(""),3e3)}catch(a){N(a.message||"Failed to upload image")}finally{J(!1)}}},V=async()=>{if(G&&i?.business)try{await k(G),H(""),P("Profile picture removed!"),setTimeout(()=>P(""),3e3)}catch(a){console.error("Failed to remove image:",a)}},W=async()=>{if(!i?.business?.phone)return;let a=`/chat/${i.business.phone}`;try{await navigator.clipboard.writeText(a),R(!0),setTimeout(()=>R(!1),2e3)}catch(a){console.error("Failed to copy link:",a)}};return!n&&v&&i?.business?(0,b.jsx)("main",{className:"min-h-screen bg-background md:bg-gradient-to-br md:from-background md:via-card md:to-background",children:(0,b.jsx)("div",{className:"max-w-2xl mx-auto p-4 md:p-6",children:(0,b.jsxs)(f.motion.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},children:[(0,b.jsx)(l.default,{href:"/dashboard",className:"inline-block mb-4 md:mb-8",children:(0,b.jsxs)(e.Button,{variant:"ghost",size:"sm",children:[(0,b.jsx)(m.ChevronLeft,{className:"w-4 h-4 mr-2"}),(0,b.jsx)("span",{className:"hidden sm:inline",children:"Back to Dashboard"}),(0,b.jsx)("span",{className:"sm:hidden",children:"Back"})]})}),(0,b.jsxs)("div",{className:"bg-card rounded-xl border border-border p-4 md:p-8 shadow-lg",children:[(0,b.jsx)("h1",{className:"text-2xl md:text-3xl font-bold mb-2",children:"Business Settings"}),(0,b.jsx)("p",{className:"text-muted-foreground mb-6 md:mb-8 text-sm md:text-base",children:"Manage your business profile and preferences"}),(0,b.jsxs)("form",{onSubmit:T,className:"space-y-6",children:[M&&(0,b.jsx)(f.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"p-4 bg-destructive/10 border border-destructive rounded-lg text-destructive",children:M}),O&&(0,b.jsx)(f.motion.div,{initial:{opacity:0},animate:{opacity:1},className:"p-3 md:p-4 bg-green-500/10 border border-green-500 rounded-lg text-green-700 dark:text-green-400 text-sm",children:O}),(0,b.jsxs)("div",{className:"flex flex-col items-center mb-6 md:mb-8 pb-6 md:pb-8 border-b border-border",children:[(0,b.jsxs)("div",{className:"relative group",children:[(0,b.jsx)("div",{className:"w-24 h-24 md:w-32 md:h-32 rounded-full overflow-hidden bg-secondary flex items-center justify-center",children:G?(0,b.jsx)(s.default,{src:G,alt:"Business logo",width:128,height:128,className:"w-full h-full object-cover"}):(0,b.jsx)(p.User,{className:"w-12 h-12 md:w-16 md:h-16 text-muted-foreground"})}),(0,b.jsx)("button",{type:"button",onClick:()=>h.current?.click(),disabled:I,className:"absolute bottom-0 right-0 p-2 bg-primary text-primary-foreground rounded-full shadow-lg hover:bg-primary/90 transition-colors disabled:opacity-50","aria-label":"Upload profile picture",children:(0,b.jsx)(o,{className:"w-4 h-4"})}),I&&(0,b.jsx)("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-full",children:(0,b.jsx)("div",{className:"w-6 h-6 border-2 border-white border-t-transparent rounded-full animate-spin"})})]}),(0,b.jsx)("input",{ref:h,type:"file",accept:"image/*",onChange:U,className:"hidden"}),(0,b.jsxs)("div",{className:"mt-4 flex gap-2",children:[(0,b.jsxs)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:()=>h.current?.click(),disabled:I,children:[G?"Change":"Upload"," Photo"]}),G&&(0,b.jsx)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:V,disabled:I,children:"Remove"})]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Business Name"}),(0,b.jsx)("input",{type:"text",value:y,onChange:a=>z(a.target.value),className:"w-full bg-input border border-border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Phone Number"}),(0,b.jsx)("input",{type:"tel",value:A,onChange:a=>B(a.target.value),className:"w-full bg-input border border-border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary",required:!0})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("label",{className:"block text-sm font-medium mb-2",children:"Address"}),(0,b.jsx)("input",{type:"text",value:C,onChange:a=>D(a.target.value),className:"w-full bg-input border border-border rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-primary",required:!0})]}),(0,b.jsxs)("div",{className:"flex items-center gap-4",children:[(0,b.jsxs)("label",{className:"flex items-center gap-2 cursor-pointer",children:[(0,b.jsx)("input",{type:"checkbox",checked:E,onChange:a=>F(a.target.checked),className:"w-4 h-4"}),(0,b.jsx)("span",{className:"text-sm font-medium",children:"Online Status"})]}),(0,b.jsx)("span",{className:`text-xs px-2 py-1 rounded-full ${E?"bg-green-500/20 text-green-700 dark:text-green-400":"bg-muted text-muted-foreground"}`,children:E?"Online":"Offline"})]}),(0,b.jsx)(e.Button,{type:"submit",disabled:K||I,className:"w-full",children:K?"Saving...":"Save Changes"})]}),i?.business?.phone&&(0,b.jsxs)("div",{className:"mt-8 pt-8 border-t border-border",children:[(0,b.jsx)("h2",{className:"text-lg font-semibold mb-2",children:"Share Chat Link"}),(0,b.jsx)("p",{className:"text-sm text-muted-foreground mb-4",children:"Share this link with customers to start conversations:"}),(0,b.jsxs)("div",{className:"flex gap-2",children:[(0,b.jsx)("code",{className:"flex-1 text-xs bg-input p-3 rounded block truncate text-foreground",children:`/chat/${i.business.phone}`}),(0,b.jsx)(e.Button,{type:"button",variant:"outline",size:"sm",onClick:W,className:"shrink-0",children:Q?(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(r,{className:"w-4 h-4 mr-2"}),"Copied!"]}):(0,b.jsxs)(b.Fragment,{children:[(0,b.jsx)(q,{className:"w-4 h-4 mr-2"}),"Copy"]})})]})]})]})]})})}):(0,b.jsx)("main",{className:"min-h-screen bg-background md:bg-gradient-to-br md:from-background md:via-card md:to-background",children:(0,b.jsxs)("div",{className:"max-w-2xl mx-auto p-4 md:p-6",children:[(0,b.jsx)(t.Skeleton,{className:"h-10 w-32 mb-8"}),(0,b.jsxs)("div",{className:"bg-card rounded-xl border border-border p-4 md:p-8 shadow-lg",children:[(0,b.jsx)(t.Skeleton,{className:"h-8 w-48 mb-2"}),(0,b.jsx)(t.Skeleton,{className:"h-4 w-64 mb-8"}),(0,b.jsxs)("div",{className:"space-y-6",children:[(0,b.jsxs)("div",{className:"flex flex-col items-center mb-6 md:mb-8 pb-6 md:pb-8 border-b border-border",children:[(0,b.jsx)(t.Skeleton,{className:"w-24 h-24 md:w-32 md:h-32 rounded-full mb-4"}),(0,b.jsx)(t.Skeleton,{className:"h-10 w-32"})]}),(0,b.jsx)(t.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(t.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(t.Skeleton,{className:"h-10 w-full"}),(0,b.jsx)(t.Skeleton,{className:"h-10 w-full"})]})]})]})})}a.s(["default",()=>v],57417)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__cf3790bb._.js.map